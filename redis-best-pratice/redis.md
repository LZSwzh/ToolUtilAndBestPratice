# Redis使用笔记
## 3.构建消息队列
消息队列利用高效的消息传递机制可以实现分布式系统的
- 应用解耦
- 弹性伸缩
- 流量消峰
- 异步通信
- 数据同步
### 3.1.消息队列的基本构成
消息队列主要存在：生产者、消费者、消息处理中心 三个角色
生产者将消息发送到一条虚拟通道上，无需等待响应。
消费者订阅或者监听该通道，取出消息，对消息进行一定的处理。
二者互不干扰，从而达到松耦合的目的。
### 3.2.三种构建方式：List、PubSub、Stream
#### <1>List
为什么可以充当消息队列？
redis提供的list结构支持，允许使用者在队列的左右两端插入数据;因此可以将list结构作为一个异步队列，将延后的任务解耦提序列化后放入字符串.
另开启一个线程从这个列表中轮询这个数据进行处理。
使用list充当消息队列的优点？
- 可以跨进程、不受限于JVM的内存上限
- 满足消息有序性
- 基于Redis的持久化机制，数据安全有保证
使用list充当消息队列的缺点？
- 无法避免消息丢失
- 仅支持单消费者消费(因为消息模型分为两种：点对点和发布订阅。List是一种点对点的消息模型，仅支持单个消费者，不支持消费者组消费)

#### <2>Pub/Sub
使用Pub/Sub充当消息队列的缺点？
- 消息无法持久化，若存在网络宕机等问题，消息会丢弃。
- 没有ACK机制保证数据的可靠性，若不存在消费者，消息直接就丢弃了。
#### <3>Stream
Stream结构支持消息持久化和主备复制功能，能够让任何客户端访问任何时刻的数据，并且能记住每一个客户端的访问位置，还能保证消息不丢失。
Stream结构是个仅追加内容的消息链表，把所有加入的消息都串起来，每个消息都有**一个唯一的 ID 和对应的内容**。==而且消息是持久化的==。


